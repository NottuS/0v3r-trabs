SRC = $(wildcard *.cpp)
OBJ = $(SRC:.cpp=.o)
EXEC = parallelsurf
CC = g++
CFLAGS = `pkg-config --cflags opencv`
LIBS = `pkg-config --libs opencv` -lcudart
GPUSURF = ../gpuSURF/lib/gpuSURF.a

.PHONY: all clean mrproper
all: $(GPUSURF) $(EXEC)

$(GPUSURF): 
	cd $(GPUSURF) && make
	
$(EXEC): $(OBJ)
	cd build && $(CC) -o $@ $(OBJ)  

%.o: %.cpp
	mkdir -p build
	$(CC) $(CFLAGS) $(LIBS) -o build/$@ -c $<

clean:
	rm -rf build *.o *~
	
mrproper:
	rm -rf $(EXEC)