SRC = $(wildcard *.cu)
OBJ = $(SRC:.cu=.o)
NVCC = /usr/local/cuda-6.5/bin/nvcc
NVCCFLAGS = -G -g -O0 --compile --relocatable-device-code=false -gencode arch=compute_20,code=compute_20 -gencode arch=compute_20,code=sm_21

.PHONY: all clean
all: gpuSURF.o 

gpuSURF.o: $(OBJ)
	@cd lib
	$(NVCC) -link gpuSURF.o $^ gpuSURF.o
		
%.o: %.cu
	@mkdir -p lib
	@echo 'Building file: $<'
	@echo 'Invoking: NVCC Compiler'
	$(NVCC) $(NVCCFLAGS) -x cu -o lib/$@ $< 
	@echo 'Finished building: $<'
	@echo ' '

clean:
	@rm -f  $(OBJ)